<div class="time-tables"> 
<% if @employee.timesheets.any? %>
  <h3> Most recent timesheet: <small>Week ending <%= @timesheets.last.week_ending %></small></h3>

<h5>Total gross pay: <%= number_to_currency(@timesheets.sum(:gross_pay)) %></h5>
<h5>Last gross amount: <%= number_to_currency(@timesheets.last.gross_pay) %></h5>
<div class="table-responsive">
  <table id="timesheets" class="table" cellspacing="0.5" width="85%">
  <thead>
    <tr>
      <th>Week</th>
      <th>Employee</th>
      <th>Title</th>
      <th>Regular</th>
      <th>Overtime</th>
      <th>Gross pay</th>
      <th>Shifts</th>
      <th>Status</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @timesheets.each do |timesheet| %>
      <% if timesheet.clocked_in? %>
        <tr class="clocked_in">
      <% else %>
        <tr class="clocked_out">
      <% end %>
        <td><%= timesheet.week_ending %></td>
        <td><%= link_to timesheet.employee.name, timesheet.employee %></td>
        <td><%= link_to timesheet.job.title, timesheet.job %></td>
        <td><%= timesheet.reg_hours %></td>
        <td><%= timesheet.ot_hours %></td>
        <td><%= number_to_currency(timesheet.gross_pay) %></td>
        <td><%= timesheet.shifts.count %></td>
        <% if timesheet.approved? %>
        <td><%= timesheet.state.titleize %> </td>
        <% else %>
        <td><%= link_to "<span class='glyphicon glyphicon-ok-circle' aria-hidden='true'></span>    Approve".html_safe, approve_timesheet_path(timesheet), method: :patch, remote: true %></td>
        <% end %>
        <td><%= link_to "<span class='glyphicon glyphicon-info-sign' aria-hidden='true'></span>     View".html_safe, timesheet, class: "btn btn-default btn-sm" %></td>
        <td><%= link_to "<span class='glyphicon glyphicon-pencil' aria-hidden='true'></span>".html_safe, edit_timesheet_path(timesheet) %></td>
        <td><%= link_to "<span class='glyphicon glyphicon-trash' aria-hidden='true'></span>".html_safe, timesheet, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
</div>



<hr>
<% end %>
<!--LAST WEEK-->
<% if @employee.timesheets.last_week.any? %>
<h3>Last week timesheets <small>Week ending <%= @last_week_timesheets.first.week_ending %></small></h3>
<h5>Payroll cost: <%= number_to_currency(@last_week_timesheets.sum(:gross_pay)) %></h5>
<div class="table-responsive">
<table id="timesheets" class="table" cellspacing="0.5" width="85%">
  <thead>
    <tr>
      <th>Employee</th>
      <th>Job Title</th>
      <th>Regular</th>
      <th>Overtime</th>
      <th>Gross Pay</th>
      <th>Shifts</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @last_week_timesheets.each do |timesheet| %>
      <% if timesheet.clocked_in? %>
        <tr class="clocked_in">
      <% else %>
        <tr class="clocked_out">
      <% end %>
    
        <td><%= link_to timesheet.employee.name, timesheet.employee %></td>
        <td><%= link_to timesheet.job.title, timesheet.job %></td>
        <td><%= timesheet.reg_hours %></td>
        <td><%= timesheet.ot_hours %></td>
        <td><%= number_to_currency(timesheet.gross_pay) %></td>
        <td><%= timesheet.shifts.count %></td>
        <td><%= link_to "<span class='glyphicon glyphicon-info-sign' aria-hidden='true'></span>     View".html_safe, timesheet, class: "btn btn-default btn-sm" %></td>
        <td><%= link_to "<span class='glyphicon glyphicon-pencil' aria-hidden='true'></span>".html_safe, edit_timesheet_path(timesheet) %></td>
        <td><%= link_to "<span class='glyphicon glyphicon-trash' aria-hidden='true'></span>".html_safe, timesheet, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
</div>
<hr>
<% end %>

<!--ALL TIMESHEETS-->
<% if @employee.timesheets.any? %>
<h3> All timesheets</h3>
<h5>Payroll cost: <%= number_to_currency(@timesheets.sum(:gross_pay)) %></h5>
<div class="table-responsive">
<table id="timesheets" class="table" cellspacing="0.5" width="85%%">
  <thead>
    <tr>
      <th>Week</th>
      <th>Employee</th>
      <th>Job Title </th>
      <th>Regular</th>
      <th>Overtime</th>
      <th>Gross Pay</th>
      <th>Shifts</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @timesheets.each do |timesheet| %>
      <% if timesheet.clocked_in? %>
        <tr class="clocked_in">
      <% else %>
         <tr class="clocked_out">
      <% end %>
    
        <td><%= timesheet.week_ending %></td>
        <td><%= link_to timesheet.employee.name, timesheet.employee %></td>
        <td><%= link_to timesheet.job.title, timesheet.job %></td>
        <td><%= timesheet.reg_hours %></td>
        <td><%= timesheet.ot_hours %></td>
        <td><%= number_to_currency(timesheet.gross_pay) %></td>
        <td><%= timesheet.shifts.count %></td>
        <td><%= link_to "<span class='glyphicon glyphicon-info-sign' aria-hidden='true'></span>     View".html_safe, timesheet, class: "btn btn-default btn-sm" %></td>
        <td><%= link_to "<span class='glyphicon glyphicon-pencil' aria-hidden='true'></span>".html_safe, edit_timesheet_path(timesheet) %></td>
        <td><%= link_to "<span class='glyphicon glyphicon-trash' aria-hidden='true'></span>".html_safe, timesheet, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
</div>
<hr>
<% end %>
</div>