<div class="col-md-4">
  <h4 class='text-center'>Account Managers</h4>
  <h5 class='text-center'><small>Based on current billing</small></h5>
 
 <%= column_chart account_managers_ranking_path %>
  
</div>

<div class="col-md-4">
  <h4 class='text-center'>Recruiters</h4>
  <h5 class='text-center'><small>Based on current billing</small></h5>
  <%= column_chart recruiter_ranking_path %>
   
  
</div>

  <div class="col-md-4">
    <h5 class='text-center'>Invoices by Company</h5>
    <h5 class='text-center'><small>Total: <%= Invoice.sum(:total).round(2) %></small></h5>
    
    <%= column_chart paid_invoices_path %>
  </div>
  <div class="col-md-9">
    <h5 class='text-center'>Open orders by fill date</h5>
    <h5 class='text-center'><small>Total: <%= Invoice.sum(:total).round(2) %></small></h5>
    <%= line_chart Timesheet.group_by_week(:created_at).sum(:total_bill) %>
  </div>
  
  <div class="col-md-3">
    <h5 class='text-center'>Total Orders by Company</h5>
    <h5 class='text-center'><small>Total: <%= Order.count %></small></h5>
    <%= line_chart Shift.current_week.group_by_day(:created_at).sum(:earnings) %>
   
    </div>
    <div class="col-md-12">
      <h5 class='text-center'>Total Hours Worked Per Month</h5>
      <h5 class='text-center'><small><%= Order.count %></small></h5>
      <%= line_chart Admin.group_by_day(:updated_at).count %>
        
     <%= column_chart  Admin.account_managers.map{|account_manager|
            {name: account_manager.name, data: account_manager.account_orders.group(:title).average(:mark_up)}
        } %>
     
    </div>
   
    <div class="col-md-12 well">
    <h5 class='text-center'>Shifts</h5>
    <h5 class='text-center'><small><%= Shift.count %></small></h5>
    <%= column_chart Employee.assigned.map{|employee|
              {name: employee.name, data: employee.shifts.group_by_week(:time_in, format: "%a").sum(:time_worked)}
          }, xtitle: "Week", ytitle: "Total Hours" %>
    
  
   
    </div>
  <div class="col-md-12 well">
      <h5 class='text-center'>Orders by Company</h5>
    <%= pie_chart Order.group(:company).count, library: {chartArea: {width:'100%'}}%>
  </div>

  <div class="col-md-12 well">
      <h5 class='text-center'>Recruiter Activity</h5>
  <%= column_chart Admin.recruiters.pluck("id").uniq.map { |c| { name: Admin.where(id: c).take.name, data: Job.where(recruiter_id: c).group_by_day(:start_date, format: "%B %d, %Y").count }  } %>
</div>
<div class="col-md-12 well">
    <h5 class='text-center'> Account Managers</h5>
    <h5 class='text-center'><small><%= Order.count %></small></h5>
   
   <%= line_chart Admin.account_managers.map { |c| { name: c.name, data: c.account_orders.includes(:timesheets).sum(:total_bill) }  } %>
       <%= line_chart Admin.account_managers.map{|am|
        {name: am.name, data: am.account_orders.includes(:timesheets).group(:week).sum(:total_bill)}
    } %>
    </div>
    <div class="col-md-12 well">
   <h5 class='text-center'>Total Hours Worked Per Day</h5>
    <h5 class='text-center'><small><%= Order.count %></small></h5>
    
   <%= column_chart Shift.group_by_period(:day, :time_in, format: "%m/%d").sum(:earnings), stacked: true %>

  
  <hr>
  
    </div>