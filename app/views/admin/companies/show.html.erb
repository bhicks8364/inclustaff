<div class="col-md-12 dark">
  <h2><%= @company.name %></h2>
  
  <div class="btn-group btn-group-justified" role="group" aria-label="...">
    
    <div class="btn-group" role="group">
      <%= link_to(new_admin_company_order_path(@company), class: "btn btn-primary") do %>
    	  <span><i class='fa fa-plus-square fa-fw'></i> New Job Order</span>
    	<% end %>
    </div>
    
    <div class="btn-group" role="group">
      <%= link_to(admin_company_orders_path(@company), class: "btn btn-primary") do %>
  		  <span><i class='fa fa-briefcase fa-fw'></i> Active Orders</span>
  		<% end %>
    </div>
    
    <div class="btn-group" role="group">
      <%= link_to(new_company_admin_registration_path, class: "btn btn-primary") do %>
  		  <span><i class='fa fa-user-plus fa-fw'></i> Add Company User</span>
  		<% end %>
    </div>
    
    <div class="btn-group" role="group">
      <%= link_to(admin_company_timesheets_path(@company), class: "btn btn-primary") do %>
      		<span>	<i class='fa fa-clock-o fa-fw'></i>Timesheets</span>
      <% end %>
    </div>
    <div class="btn-group" role="group">
      <%= link_to(admin_company_invoices_path(@company), class: "btn btn-primary") do %>
      		<span>	<i class='fa fa-usd fa-fw'></i>Invoices</span>
      <% end %>
    </div>
</div>
  <!-- Nav tabs -->
  <ul class="nav nav-tabs nav-justified" role="tablist">
    <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">Company Information</a></li>
    <li role="presentation"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">Job Orders</a></li>
    <li role="presentation"><a href="#employees" aria-controls="employees" role="tab" data-toggle="tab">Employees</a></li>
    <li role="presentation"><a href="#company-contacts" aria-controls="company-contacts" role="tab" data-toggle="tab">Company Admins</a></li>
    <li role="presentation"><a href="#invoices" aria-controls="invoices" role="tab" data-toggle="tab">Invoices</a></li>
    <li role="presentation"><a href="#timesheets" aria-controls="timesheets" role="tab" data-toggle="tab">Timesheets</a></li>
  </ul>
 
  <div class="tab-content">
  <div role="tabpanel" class="tab-pane fade in active" id="home">
    
    <div class='well'>
      <h3>Company Information</h3>
    
      <% if @company.orders.count == 0 %>
      <div id="no-orders-alert" class="alert alert-danger" role="alert">
      
      <h5 class='text-center'> <i class="fa fa-exclamation-triangle fa-fw fa-border"></i><%= @company.name %> doesn't have any job orders. <br>
      Please add a new job order below.</h5>
      	<%= link_to "Add Job Order", new_admin_company_order_path(@company), class: 'btn btn-primary' %>
      </div>
      <% end %>
  
      <address class="">
        <%= @company.address %><br>
        <%= @company.city %>, <%= @company.state %> <%= @company.zipcode %><br>
        <abbr title="Phone">PH:</abbr>  <%= @company.phone_number || "Unavailable"  %> 
      </address>
      <address class="">
        <strong><%= @company.contact_name %></strong><br>
        <a href="mailto:#"><%= @company.contact_email %></a>
      </address>
  
      <span class="text-center">Balance: <%= number_to_currency(@company.balance) %></span>
  
      </div>
      <div class=''>
        <%= column_chart @company.jobs.map{|job|
                {name: job.employee.name, data: job.shifts.group_by_week(:time_in, format: "%B %d, %Y").sum(:time_worked)}
            }, xtitle: "Week", ytitle: "Total Hours" %>
      </div>

  </div>
    
  <div role="tabpanel" class="tab-pane fade " id="company-contacts">
    <div class='well'>
      
      <h3>Company Contacts</h3>
       <%= render 'admin/companies/company_users' %>
    </div>
   
    <%= link_to(admin_company_path(@company), method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-danger") do %>
      <i class='fa fa-trash'></i>
      <span>Delete Company</span>
    <% end %>
 

    
  </div>
  <div role="tabpanel" class="tab-pane fade" id="profile">
    
     <div class='well'>
       <h3>Current Job Orders</h3>
       <br>
        <%= @company.orders.map(&:title).join(",") %>
     </div>
    <%= link_to(edit_admin_company_path(@company), class: "btn btn-primary") do %>
				<i class='fa fa-pencil'></i>
					<span>Edit Company</span>
				<% end %>
  </div>
  <div role="tabpanel" class="tab-pane fade" id="employees">
     <div class='col-md-6'>
       <% if @company.jobs.active.any? %>
       <h3>Current Employees</h3>
    <%= render @jobs %>
    <% else %>
      <h3>No employees to display.</h3>
      <% end %>
     </div>
     <div class='table-responsive'>
       <%= render 'admin/shifts/week_calendar', shifts: @company.shifts.current_week %>
     </div>
  </div>
  <div role="tabpanel" class="tab-pane fade" id="invoices">
     <div class='col-md-6 well'>
       <% if @company.invoices.paid.any? %>
       <h3>Paid Invoices</h3>
    <%= render @company.invoices.paid.order(created_at: :desc) %>
    <% else %>
      <h3>No paid invoices to display.</h3>
      <% end %>
     </div>
     <div class='col-md-6 well'>
       <% if @company.invoices.unpaid.any? %>
       <h3>Open Invoices</h3>
    <%= render @company.invoices.unpaid.order(created_at: :desc) %>
    <% else %>
      <h3>No open invoices to display.</h3>
      <% end %>
     </div>
  </div>
 
  <div role="tabpanel" class="tab-pane fade" id="timesheets">
    <div class='well'>
      <% if @company.timesheets.any? %>
       <h3>Timesheets</h3>
      <%= render 'admin/timesheets/table', timesheets: @company.timesheets %>
      <% else %>
      <h3>No timesheets to display.</h3>
      <% end %>
    </div>
  </div>
</div>
<%= link_to "New Company", new_admin_company_path, class: "btn btn-primary" %>
</div>
