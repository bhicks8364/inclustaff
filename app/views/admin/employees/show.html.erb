<div class='col-md-12 transbox'>
 

<span id="user-role">  <strong><% if @user.can_edit? %> <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> <% end %></strong> </h3></span> 
          
        <% if @employee.dns? %>
        <div class="alert alert-danger fade in text-center">
    		<button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button>
    		<i class="fa fa-exclamation-triangle fa-fw fa-lg"></i>
    			<h2><strong>Marked as DNS</strong>  </h2> 
	    </div>
       
        <% end %>
    
        
 <h2 class="page-header text-center"><%= @user.name %>'s Employee Profile  </h2>
    
<!--NAV TABS-->
    <div id='profile-nav' class=''>
      <!-- Nav tabs -->
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">Home</a></li>
        <li role="presentation"><a href="#matching_orders" aria-controls="matching_orders" role="tab" data-toggle="tab">Recommended Positions</a></li>
        <li role="presentation"><a href="#payroll" aria-controls="payroll" role="tab" data-toggle="tab">Payroll Information</a></li>
        <li role="presentation"><a href="#work_history" aria-controls="work_history" role="tab" data-toggle="tab">Work History</a></li>
        <li role="presentation"><a href="#skills-tab" aria-controls="skills-tab" role="tab" data-toggle="tab">Skills</a></li>
        <% if @employee.assigned? %>
        <li role="presentation"><a href="#current-job" aria-controls="current-job" role="tab" data-toggle="tab">Current Job</a></li>
        <li role="presentation"><a href="#timesheets" aria-controls="timesheets" role="tab" data-toggle="tab">Timesheets</a></li>
        <li role="presentation"><a href="#shifts" aria-controls="shifts" role="tab" data-toggle="tab">Shifts</a></li>
        <% end %>
        <% if @current_admin.present? %>
        <li role="presentation"><a href="#settings" aria-controls="settings" role="tab" data-toggle="tab">Settings</a></li>
        <% end %>
      </ul>
      <!--TABS START HERE-->
      <div class="tab-content">
        <!--HOME TAB-->
      <div role="tabpanel" class="tab-pane fade in active" id="home">
           <div class='well well-sm text-center'><span class='pull-left'><i class="fa fa-envelope-o"></i>  <%= @employee.email %></span><%= @user.address %>, <%= @user.state %> <%= @user.zipcode %><span class='pull-right'><i class="fa fa-phone-square"></i>  <%= @employee.phone_number %></span> </div>
        
     <% if @employee.jobs.inactive.any? %>
     <div class='list-group col-md-6 well'>
              <h5 class='text-center'>Past Job Assignments</h5>
        <% @employee.jobs.inactive.each do |job| %>
       
          <h4><%= job.company %> <small> <%= job.title %></small></h4>
          <small> Assignment duration: <%= distance_of_time_in_words(job.start_date, job.end_date, include_seconds: true) %></small>
          <p><%= job.start_date.stamp('11/12') %> - <%= job.end_date.stamp('11/12') %></p>
           <div class='list-group-item black'>
          <strong>Comments</strong>
           <% job.comments.each do |comment| %>
                <%= render 'comments/comment', comment: comment %>
            <% end %>
           </div>
    <% end %>
       </div>
       <% end %>
       <% if @employee.jobs.active.any? %>
     <div class='list-group col-md-6 well'>
              <h5 class='text-center'>Current Job Assignment</h5>
        <% @employee.jobs.active.each do |job| %>
          <h4><%= job.company %> <small> <%= link_to job.title, admin_job_path(job) %></small></h4>
           <div class='list-group-item black'>
          <strong>Comments</strong>
           <% job.comments.each do |comment| %>
                <%= render 'comments/comment', comment: comment %>
            <% end %>
           </div>
    <% end %>
       </div>
       <% end %>
       
        <% if @employee.unassigned? && @applications.any? %>
        <h2>Applications</h2>
        <div class='list-group'>
			<% @applications.each do |event| %>
			  <% if lookup_context.template_exists?(event.action, "events/activities", true) %>
			    <%= render partial: "events/activities/#{event.action}", locals: {event: event} %>
			  <% end %>
			<% end %>
		</div>
    		<% end %>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="matching_orders">
        
         <h2 class="text-center">Matching Job Orders  </h2>
      
        <div class=''>
          <% @employee.matching_orders.each do |order| %>
              <%= render order %>
          <% end %>
        </div>
       
  
       
        
    
    </div>
      <!--EMPLOYEE PROFILE TAB-->
    <div role="tabpanel" class="tab-pane fade" id="payroll">
         <h2 class="text-center">Payroll Information  </h2>
         <div class='col-md-4'>
            <h3>By Week <small>over 30 hours</small></h3>
            <div class='list-group'><% @employee.shifts.report_by_week.each do |k, v| %>
                 <li class='list-group-item list-group-item-info'><strong><%=  k.stamp("Oct 2, 2015") %> </strong> -  Total Hours: <%= v.round(2) %>
                     <span class='label label-info black pull-right'><% if v > 30 %>Eligible<% else %> Not Eligible <% end %></span>
                 
                 </li>
                 <% end %>
            </div>
        </div>
        
        <div class='col-md-4'>
        <h3>By Month <small>over 120 hours</small></h3>
        <div class=' list-group'><% @employee.shifts.report_by_month.each do |k, v| %>
             <li class='list-group-item list-group-item-info'><strong><%=  k.stamp("October 2015") %> </strong> -  Total Hours: <%= v.round(2) %>
                 <span class='label label-info black pull-right'><% if v > 120 %>Eligible<% else %> Not Eligible <% end %></span>
             </li>
             <% end %>
        </div>
        </div>
        
        <div class='col-md-4'>
            <h3>By Year <small>over 1560 hours</small></h3>
            <div class='list-group'><% @employee.shifts.report_by_year.each do |k, v| %>
                 <li class='list-group-item list-group-item-info'><strong><%=  k.stamp("2015") %> </strong> -  Total Hours: <%= v.round(2) %>
                     <span class='label label-info black pull-right'><% if v > 1560 %>Eligible<% else %> Not Eligible <% end %></span>
                 
                 </li>
                 <% end %>
            </div>
        </div>
        <div class='col-md-4 well'>
            <%= @employee.ssn %><br>
          CODE:  <%= @employee.code %><br>
           <strong>Last sign in:</strong> <%= @user.current_sign_in_at %> -
              <%= @user.current_sign_in_ip %>
        </div>
      
    
          
          
        
    
      </div>
      <!--TIMESHEETS TAB-->
      <div role="tabpanel" class="tab-pane fade" id="timesheets">
        
        <% if @employee.timesheets.any? %>
        
        <% if user_signed_in? %>
         <%= render 'employee/timesheets/table' %>
         <% elsif admin_signed_in? %>
         <%= render 'admin/timesheets/table' %>
         <% end %>
    
          <% end %>
    
      </div>
      
      <!--CURRENT JOB TAB-->
      <div role="tabpanel" class="tab-pane fade" id="current-job">
        
      <% if @current_job %>
      <h4><%= @current_job.title %><smal><%= number_to_currency(@current_job.pay_rate) %></smal></h4>
        <%= render @current_job %>
        <% else %>
        <h3><%= @employee.first_name %> is currently unassigned.</h3>
      <% end %>
         
                    
            
    
                
      </div>
      <div role="tabpanel" class="tab-pane fade" id="shifts">
        
      <% if @employee.assigned? && @employee.shifts.any? %>
      	<h1>Calendar</h1>
        <div class='well white'>
          <%= render 'admin/shifts/calendar' %>
        </div>
        <% else %>
        <h3> <%= @employee.first_name %> is currently unassigned.</h3>
      <% end %>
         
                    
            
    
                
      </div>
      <div role="tabpanel" class="tab-pane fade" id="work_history">
        <div class='dark white'>
        <% if @employee.work_histories.any? %>
         
           
           <%= render 'work_histories/table' %>
           
       
        <% else %>
          <p>No Work History Available.</p>
    
        <% end %>
        <% if admin_signed_in? %>
             <%=link_to "Add Work History", new_admin_employee_work_history_path(@employee), class: 'btn btn-primary' %>
           <% elsif user_signed_in? %>
             <%= link_to "Add Work History", new_work_history_path, class: 'btn btn-primary' %>
           <% end %>
         </div>
           
      </div>
      <div role="tabpanel" class="tab-pane fade" id="skills-tab">
          <div class='col-md-8 '>
        <% if @skills.count < 1 %>
           <h4 id='no-skills' class="text-center">This employee has no skills entered.</h4>
          <% else %>
           <h4 class='text-center'>Skills</h4>
            <%= pie_chart @skills.group(:name).count %>
          <% end %>
         </div>
            <div  id='skills' class='col-md-4'>
             <% @employee.skills.each do |skill| %>
              <%= render "admin/skills/skill", skill: skill %>
            <% end %>
             
            </div>
            <div class="col-md-4 tag_cloud">
        		<h1>Candidate Skills</h1>
        	  <% tag_cloud @employee.tag_counts, %w[css1 css2 css3 css4] do |tag, css_class| %>
        	    <%= link_to tag.name, tag_path(tag.name), class: css_class %>
        	  <% end %>
        	</div>
             <div class='form col-md-8'>
               <%= render partial: "admin/skills/form", locals: {skillable: @employee} %>
             </div>
             
             
        </div>  
      <!--SETTINGS TAD ADMIN ONLY ----> 
        <div role="tabpanel" class="tab-pane fade" id="settings">
            <div class='col-md-4'>
            <%= link_to "Edit Employee", edit_admin_employee_path(@employee), class: 'btn btn-primary' %>
             
            </div>

          
      </div>
    </div>
  
  
  
</div>
